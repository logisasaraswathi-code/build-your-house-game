<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dream House Builder Game</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
        background-color: #f0f8ff;
        margin: 0;
        padding: 0;
    }
    h1 {
        color: #2c3e50;
        margin: 20px 0;
    }
    .hidden { display: none; }
    button {
        font-size: 16px;
        padding: 10px 15px;
        margin: 5px;
        cursor: pointer;
    }
    #moneyDisplay {
        font-size: 24px;
        margin: 10px 0;
    }
    #feedback {
        font-size: 18px;
        margin: 10px 0;
        min-height: 30px;
        transition: all 0.5s;
    }
    /* Stage 2 sliders */
    .slider-container {
        margin: 10px 0;
        width: 300px;
        display: inline-block;
        text-align: left;
    }
    .slider-container label {
        display: block;
        margin-bottom: 5px;
    }
    .slider-container input[type=range] {
        width: 100%;
    }
    /* House Stage */
    #houseContainer {
        display: grid;
        grid-template-columns: repeat(5, 60px);
        grid-gap: 5px;
        justify-content: center;
        margin-top: 20px;
    }
    .block {
        width: 60px;
        height: 60px;
        background-color: #ddd;
        border: 2px solid #2c3e50;
        transition: background-color 0.5s, transform 0.3s;
    }
    .filled {
        background-color: #3498db;
        transform: scale(1.1);
    }
    .furniture {
        background-color: #e67e22;
    }
    .decoration {
        background-color: #f1c40f;
    }
</style>
</head>
<body>

<h1>Dream House Builder</h1>

<!-- Stage 1: Money Earning -->
<div id="stage1">
    <div id="moneyDisplay">Money: ‚Çπ0</div>
    <div>
        <button onclick="earnMoney('sunny')">Predict Sunny ‚òÄÔ∏è</button>
        <button onclick="earnMoney('rain')">Predict Rain üåßÔ∏è</button>
        <button onclick="earnMoney('storm')">Predict Storm üå©Ô∏è</button>
        <button onclick="earnMoney('mystery')">Open Mystery Box üéÅ</button>
    </div>
    <div id="feedback"></div>
    <div>Round: <span id="roundDisplay">1</span> / 5</div>
</div>

<!-- Stage 2: Allocation -->
<div id="stage2" class="hidden">
    <h2>Allocate Your ‚Çπ20,000</h2>
    <div id="remainingMoney">Remaining Money: ‚Çπ20000</div>

    <div class="slider-container">
        <label>Infrastructure (Bricks, Cement, Windows) - ‚Çπ<span id="infraAmount">0</span></label>
        <input type="range" id="infra" min="0" max="20000" step="100" value="0" oninput="updateAllocation()">
    </div>
    <div class="slider-container">
        <label>Furniture (Beds, Sofas, Tables) - ‚Çπ<span id="furnAmount">0</span></label>
        <input type="range" id="furn" min="0" max="20000" step="100" value="0" oninput="updateAllocation()">
    </div>
    <div class="slider-container">
        <label>Decoration (Paintings, Lamps, Curtains) - ‚Çπ<span id="decorAmount">0</span></label>
        <input type="range" id="decor" min="0" max="20000" step="100" value="0" oninput="updateAllocation()">
    </div>
    <button onclick="goToStage3()">Build House üè†</button>
    <div id="allocationFeedback" style="color:red;margin-top:10px;"></div>
</div>

<!-- Stage 3: House Construction -->
<div id="stage3" class="hidden">
    <h2>Your Dream House</h2>
    <div id="houseContainer"></div>
    <div id="finalMessage" style="font-size:22px; margin-top:20px;"></div>
</div>

<script>
/* ===== Stage 1: Earning Money ===== */
let money = 0;
let round = 1;
const totalRounds = 5;
const targetMoney = 20000;
const feedback = document.getElementById('feedback');
const moneyDisplay = document.getElementById('moneyDisplay');
const roundDisplay = document.getElementById('roundDisplay');

function earnMoney(choice) {
    let gain = 0;
    let color = 'green';
    const rand = Math.random();

    if(choice === 'sunny') {
        if(rand < 0.5) gain = 5000; else gain = -2000;
    } else if(choice === 'rain') {
        if(rand < 0.35) gain = 3000; else gain = -1500;
    } else if(choice === 'storm') {
        if(rand < 0.15) gain = -2000; else gain = 1000;
    } else if(choice === 'mystery') {
        if(rand < 0.05) gain = 10000; // rare bonus
        else if(rand < 0.5) gain = 3000;
        else gain = -1000;
    }

    money += gain;
    if(money < 0) money = 0;
    moneyDisplay.innerText = `Money: ‚Çπ${money}`;
    roundDisplay.innerText = round;

    if(gain > 0 && rand >=0.05) feedback.innerText = `You gained ‚Çπ${gain}! üåû`;
    else if(gain < 0) { feedback.innerText = `Oops! You lost ‚Çπ${-gain}! üå©Ô∏è`; color='red'; }
    else if(rand < 0.05) { feedback.innerText = `üéâ Lucky Bonus! +‚Çπ${gain}`; color='gold'; }

    feedback.style.color = color;
    feedback.style.fontWeight = 'bold';

    round++;
    if(round > totalRounds){
        document.getElementById('stage1').classList.add('hidden');
        document.getElementById('stage2').classList.remove('hidden');
        initStage2();
    }
}

/* ===== Stage 2: Allocation ===== */
let infraVal = 0, furnVal = 0, decorVal = 0;
function initStage2(){
    document.getElementById('infra').max = money;
    document.getElementById('furn').max = money;
    document.getElementById('decor').max = money;
    updateAllocation();
}

function updateAllocation(){
    infraVal = parseInt(document.getElementById('infra').value);
    furnVal = parseInt(document.getElementById('furn').value);
    decorVal = parseInt(document.getElementById('decor').value);

    const total = infraVal + furnVal + decorVal;
    const remaining = money - total;
    document.getElementById('infraAmount').innerText = infraVal;
    document.getElementById('furnAmount').innerText = furnVal;
    document.getElementById('decorAmount').innerText = decorVal;
    document.getElementById('remainingMoney').innerText = `Remaining Money: ‚Çπ${remaining}`;
    if(remaining < 0){
        document.getElementById('allocationFeedback').innerText = "You cannot allocate more than total money!";
    } else {
        document.getElementById('allocationFeedback').innerText = "";
    }
}

function goToStage3(){
    const total = infraVal + furnVal + decorVal;
    if(total > money){
        document.getElementById('allocationFeedback').innerText = "Allocation exceeds earned money!";
        return;
    }
    document.getElementById('stage2').classList.add('hidden');
    document.getElementById('stage3').classList.remove('hidden');
    buildHouse();
}

/* ===== Stage 3: House Construction ===== */
function buildHouse(){
    const houseContainer = document.getElementById('houseContainer');
    houseContainer.innerHTML = '';

    // Blocks for Infrastructure
    const infraBlocks = Math.floor(infraVal / 1000);
    const furnBlocks = Math.floor(furnVal / 1000);
    const decorBlocks = Math.floor(decorVal / 1000);

    const totalBlocks = infraBlocks + furnBlocks + decorBlocks;
    for(let i=0;i<totalBlocks;i++){
        const block = document.createElement('div');
        block.classList.add('block');
        if(i<infraBlocks) block.classList.add('filled');
        else if(i<infraBlocks+furnBlocks) block.classList.add('furniture');
        else block.classList.add('decoration');
        houseContainer.appendChild(block);
        // Animate block
        setTimeout(()=>{ block.style.transform = "scale(1.1)"; }, i*200);
    }

    // Feedback message
    const msg = document.getElementById('finalMessage');
    if(totalBlocks >= 20){
        msg.innerText = "üéâ Congratulations! You built your dream house!";
        msg.style.color = 'green';
    } else {
        msg.innerText = "üí∏ House incomplete! Try allocating better next time.";
        msg.style.color = 'red';
    }
}
</script>

</body>
</html>
